# 基础模块配置
server.modules = (
    "mod_access",
    "mod_alias",
    "mod_cgi",
    "mod_rewrite"
)

# 服务器基础参数
server.port          = 8080
server.username      = "http"
server.groupname     = "http"
server.document-root = "/nut/html"
server.errorlog      = "/dev/null"

# 禁止目录列表显示
dir-listing.activate = "disable"

# CGI路径映射
alias.url = (
    "/cgi-bin/" => "/nut/cgi-bin/"
)

# 关键配置：将根路径重写为CGI脚本
url.rewrite-once = (
    "^/$" => "/cgi-bin/upsstats.cgi"
)

# CGI处理器配置
$HTTP["url"] =~ "^/cgi-bin" {
    cgi.assign = (
        ".cgi" => ""  # 使用系统PATH查找解释器
    )
}

# MIME类型映射
mimetype.assign = (
    ".html" => "text/html",
    ".txt"  => "text/plain",
    ".png"  => "image/png",
    ".css"  => "text/css"
)